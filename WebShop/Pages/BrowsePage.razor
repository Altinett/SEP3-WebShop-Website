@page "/browse"
@using global::Shared
@using BlazorWasm.Services.Http
@using BlazorWasm.Services


<Grid>
    @foreach (Product product in products)
    {
        <GridItem
            Id=@product.Id
            Img=@product.Image
            name=@product.name
            amount=@product.amount
            description=@product.description
            price=@product.Price
            InStock=@product.InStock/>
    }

</Grid>
<Basket />

@code {
    private List<Product> products = new();
    private ProductService _productService = ProductService.getInstance();

    protected override async Task OnInitializedAsync()
    {
        try {
            if (_productService.GetProducts() == null){
                products = await _productService.UpdateProducts();
            } else {
                _productService.UpdateProducts();
                products = _productService.GetProducts();
            }
        } catch (Exception e) {
            Console.WriteLine(e);
        }
    }
}